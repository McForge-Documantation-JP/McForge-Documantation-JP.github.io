<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>World Saved Data - Forge Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  <link href="../../css/style_fixes.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "World Saved Data";
    var mkdocs_page_input_path = "datastorage\\worldsaveddata.md";
    var mkdocs_page_url = "/datastorage/worldsaveddata/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> Forge Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../../styleguide/">Style Guide</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gettingstarted/">Home</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gettingstarted/structuring/">Structuring Your Mod</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../gettingstarted/autoupdate/">Forge Update Checker</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Concepts</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../concepts/sides/">Sides</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../concepts/registries/">Registries</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Blocks</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../blocks/blocks/">Home</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../blocks/interaction/">Interaction</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Blockstates</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../blockstates/states/">Intro to Blockstates</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../blockstates/introduction/">Intro to Blockstate JSONs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../blockstates/forgeBlockstates/">Forge Blockstate JSON</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Items</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../items/items/">Home</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Events</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../events/intro/">Basic Usage</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Networking</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/">Home</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/overview/">Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../networking/simpleimpl/">SimpleImpl</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Data Storage</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../capabilities/">Capabilities</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">World Saved Data</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#world-saved-data">World Saved Data</a></li>
                
                    <li><a class="toctree-l4" href="#declaration">Declaration</a></li>
                
                    <li><a class="toctree-l4" href="#registration-and-usage">Registration and Usage</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../extendedentityproperties/">Extended Entity Properties</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Utilities</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../utilities/oredictionary/">OreDictionary</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Effects</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../effects/sounds/">Sounds</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Conventions</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../conventions/versioning/">Versioning</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../conventions/locations/">Locations</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../../conventions/loadstages/">Loading Stages</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">Forge Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Data Storage &raquo;</li>
        
      
    
    <li>World Saved Data</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="world-saved-data">World Saved Data</h1>
<p>The World Saved Data system allows attaching data to worlds, either per dimension, or global.</p>
<h2 id="declaration">Declaration</h2>
<p>The basis of the system is the <code>WorldSavedData</code> class. This class provides the basic methods used to manage the data:</p>
<ul>
<li><code>writeToNBT</code>: Allows the implementation to write data to the world.</li>
<li><code>readFromNBT</code>: Allows the implementation to load previously saved data.</li>
<li><code>markDirty</code>: This method is not overridden by the implementation. Instead, it must be called after changing the data, to notify Minecraft that there are changes that need to be written. If not called, the existing data will be kept instead, and <code>writeToNBT</code> will not get called.</li>
</ul>
<p>An implementation will override this class, and instances of this implementation will be attached to the <code>World</code> objects, ready to store any required data.</p>
<p>A basic skeleton may look like this:</p>
<pre><code class="Java">public class ExampleWorldSavedData extends WorldSavedData {
  private static final String DATA_NAME = MODID + &quot;_ExampleData&quot;;

  // Required constructors
  public ExampleWorldSavedData() {
    super(DATA_NAME);
  }
  public ExampleWorldSavedData(String s) {
    super(s);
  }

  // WorldSavedData methods
}
</code></pre>

<h2 id="registration-and-usage">Registration and Usage</h2>
<p>The WorldSavedData is loaded and/or attached to the world on demand. A good practice is to create a static get method that will load the data, and if not present, attach a new instance.</p>
<p>There are two ways to attach the data: per dimension, or globally. Global data will be attached to a shared map, that will be obtainable from any instance of the World class, while per-world data will not be shared across dimensions. Keep in mind the separation between client and server, as they get separate instances of global data, so if data is needed on both sides, manual synchronization will be required.</p>
<p>In code, these storage locations are represented by two instances of <code>MapStorage</code> present in the World object. The global data is obtained from <code>World#getMapStorage()</code>, while the per-world map is obtained from <code>World#getPerWorldStorage()</code>.</p>
<p>The existing data can be obtained using <code>MapStorage#getOrLoadData</code>, and new data can be attached using <code>MapStorage#setData</code>.</p>
<pre><code class="Java">public static ExampleWorldSavedData get(World world) {
  // The IS_GLOBAL constant is there for clarity, and should be simplified into the right branch.
  MapStorage storage = IS_GLOBAL ? world.getMapStorage() : world.getPerWorldStorage();
  ExampleWorldSavedData instance = (ExampleWorldSavedData) storage.getOrLoadData(ExampleWorldSavedData.class, DATA_NAME);

  if (instance == null) {
    instance = new ExampleWorldSavedData();
    storage.setData(DATA_NAME, instance);
  }
  return instance;
}
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../extendedentityproperties/" class="btn btn-neutral float-right" title="Extended Entity Properties">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../capabilities/" class="btn btn-neutral" title="Capabilities"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../capabilities/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../extendedentityproperties/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
